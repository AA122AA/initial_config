---
- name: Make linux user-friendly.
  hosts: all
  vars:
    the_user: "{{ ansible_user_id }}"

  tasks:
  - name: Install zsh.
    yum: 
      name: zsh
      state: latest
    become: true

  - name: Make zsh default.
    become: yes
    user:
      name: "{{ the_user }}"
      shell: /bin/zsh

  - name: Clone oh-my-zsh.
    git:
      repo: https://github.com/ohmyzsh/ohmyzsh.git
      dest: ~/.oh-my-zsh

  - name: Download configs.
    git:
      repo: https://github.com/AA122AA/initial_config
      dest: ~/initial_config
      clone: true
      update: true

  - name: Copy config.
    copy:
      remote_src: true
      src: "{{ item.src }}"
      dest: "{{ item.dest }}"
      owner: centos
      group: centos
      mode: 0644
    with_items:
      - src: /home/centos/initial_config/vimrc
        dest: /home/centos/.vimrc
      - src: /home/centos/initial_config/zshrc
        dest: /home/centos/.zshrc

  - name: Register vim version
    ansible.builtin.debug:
      var: ansible_facts.packages['vim-common'][0]['version'][:1]
    register: vimVersion

  - name: Check if register works.
    debug:
      var: vimVersion
    when: vimVersion | int < 8

        #  - name: Print the package facts
        #    ansible.builtin.debug:
        #      var: ansible_facts.packages['vim-common'][0]['version'][:1]



        #  - name: Install development tools
        #    yum:
        #      - name: "@Development Tools"
        #        - name: ncurses-devel
